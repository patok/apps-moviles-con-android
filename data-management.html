<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Desarrollo de Aplicaciones con Android - Seminario 2 (AUS)</title>

		<meta name="description" content="">
		<meta name="author" content="Patricio Keilty">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/simple.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->

<style>
.reveal section img {
  border: none;
}
</style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Apps móviles con Android</h1>
					<h2>Seminario 2 - Analista Universitario en sistemas</h2>
					<h4></h4>
					<p>
						<small>Created by <a href="http://keilty.com.ar">Patricio Keilty</a> / <a href="http://twitter.com/patokeilty">@patokeilty</a></small>
					</p>
                    <p>
                        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
                            <img alt="Licencia Creative Commons" style="border-width:0" src="img/cc-by-nc-sa-88x31.png" />
                        </a>
                    </p>
				</section>

				<section>
					<h1>Gestión de datos</h1>
					<h2>Opciones</h2>
					<p>Android provee distintas opciones a la hora de almacenar datos:
                        <ul>
                        <li>Shared Preferences (preferencias)</li>
			<li>almacenamiento interno (sistema de archivos)</li>
                        <li>almacenamiento externo (sistema de archivos removible)</li>
                        <li>base de datos SQLite</li>
                        </ul>				
				</section>

				<section>
					<h2>Preferencias</h2>
<p><strong><a href="http://developer.android.com/reference/android/content/SharedPreferences.html">SharedPreferences</a></strong> permite a una aplicación almacenar y gestionar una cantidad mínima de datos primarios; consiste de un almacén de pares clave-valor (clave: string correspondiente al nombre de la preferencia, valor: tipo primitivo como float, int, string.<p> Las preferencias son persisten de la sesión de usuario, porque se almacena en el fs privado de la app, y se puede recuperar luego.<p>Típicamente uno almacena en las preferencias datos particulares de usuario de la aplicación: credenciales, opciones de configuración como estilos, selecciñon o activación de funcionalidad de la app, etc.
				</section>

				<section>
					<h2>Preferencias</h2>
<p>Para obtener un objeto SharedPreferences la app utiliza uno de estos métodos:

                        <ul>
                        <li class="fragment fade-in"><a href="http://developer.android.com/reference/android/content/Context.html#getSharedPreferences(java.lang.String, int)">getSharedPreferences()</a>- usado para recuperar ficheros de preferencias identificados por nombre, especificado en el primer parámetro.</li>
                        <li class="fragment fade-in"><a href="http://developer.android.com/reference/android/app/Activity.html#getPreferences(int)">getPreferences()</a> - para preferences exclusivas de Activity (no requiere proveer un nombre).</li>
                        </ul>

<p class="fragment fade-in">luego de puede escribir mediante
 
                        <ol>
                        <li class="fragment fade-in">obtener un <a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html">SharedPreferences.Editor</a> llamando a <a href="http://developer.android.com/reference/android/content/SharedPreferences.html#edit()">edit()</a></li>
                        <li class="fragment fade-in">setear valores con <a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#putBoolean(java.lang.String, boolean)">putBoolean()</a> o <a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#putString(java.lang.String, java.lang.String)">putString()</a></li>
                        <li class="fragment fade-in">persistir los valores con <a href="http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#commit()">commit()</a></li>
                        </ol>
<br/><br/>
<p class="fragment fade-in">para leer usa los métodos como <a href="http://developer.android.com/reference/android/content/SharedPreferences.html#getBoolean(java.lang.String, boolean)">getBoolean()</a> y <a href="http://developer.android.com/reference/android/content/SharedPreferences.html#getString(java.lang.String, java.lang.String)">getString()</a>
 
				</section>

				<section>
					<h2>UI p/ Preferencias</h2>
<p>Android provee convenientemente recursos de tipo Preference (definición .xml) y <strong>PreferenceActivity</strong> y también una <strong>PreferenceFragment</strong><br/>Los pasos para crear consisten de
                        <ol>
                        <li class="fragment fade-in">crear un recurso de tipo Preferences, fichero de nombre prefs.xml</li>
                        <li class="fragment fade-in">implementar un PrefsActivity que infle el fichero res prefs.xml</li>
                        <li class="fragment fade-in">registrar la nueva PrefsActivity en AndroidManifest.xml</li>
                        <li class="fragment fade-in">proveer una forma de invocar dicho activity (típicamente un menú)</li>
                        </ol>
				</section>

				<section>
					<h2>SQLite</h2>
<p><strong>SQLite</strong> es una base de datos relacional embebida muy difundida, adoptada por Android. Emplea SQL standard 
<br/>Sus características mas sobresalientes son:
                        <ul>
                        <li class="fragment grow">cero configuración</li>
                        <li class="fragment grow">no tiene server: no hay proceso SQLite corriendo</li>
                        <li class="fragment grow">footprint reducido (&lt; 300KB)</li>
                        <li class="fragment grow">usa un único fichero de datos</li>
                        <li class="fragment grow">es de código abierto</li>
                        </ul>

				</section>

				<section>
					<h2>SQLite</h2><h3>SQLiteOpenHelper</h3>
<p>Android provee dentro de su API <strong><a href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html">SQLiteOpenHelper</a></strong> para simplificar la creación, upgrade y conexión a una base de datos SQLite.

				</section>

				<section>
			<h2>SQLiteOpenHelper</h2>
<p>La forma recomendada es crear un subclase de <strong><a href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html">SQLiteOpenHelper</a></strong>, y redefinir onCreate() en el cual se ejecutan las sentencias SQL para creación de la bbdd.

<p><pre><code data-trim>
public class DictionaryOpenHelper extends SQLiteOpenHelper {

    private static final int DATABASE_VERSION = 2;
    private static final String DICTIONARY_TABLE_NAME = "dictionary";
    private static final String DICTIONARY_TABLE_CREATE =
                "CREATE TABLE " + DICTIONARY_TABLE_NAME + " (" +
                KEY_WORD + " TEXT, " +
                KEY_DEFINITION + " TEXT);";

    DictionaryOpenHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(DICTIONARY_TABLE_CREATE);
    }
}
</code></pre></p>


				</section>

				<section>
					<h2>SQLite</h2><h3>Migraciones y onUpgrade()</h3>
<p>Así como onCreate() se emplea para crear por única vez la bbdd, <a href="">onUpgrade()</a> se emplea para migrar de una versión a otra, es llamado cada vez que detecta un cambio en el nro de version de la base.<br/>
Entonces, típicamente vamos a ejecutar todos los <strong>CREATE TABLE</strong> en <strong>onCreate()</strong> para crear la base cuando no existe. En una app productiva, usaremos <strong>ALTER TABLE</strong> en el método <strong>onUpgrade()</strong> cuando hay cambios de esquema, lo cual es complejo.

				</section>


				<section>
					<h2>SQLite</h2><h3>Usando la bbdd</h3>

<p>Obtenemos un objeto <a href="http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html"><strong>SQLiteDatabase</strong></a> a partir del helper para read-only o read-write respectivamente invocando: 
                        <ul>
                        <li class="fragment grow"><a href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#getReadableDatabase()">getReadableDatabase()</a></li>
                        <li class="fragment grow"><a href="http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html#getWritableDatabase()">getWritableDatabase()</a></li>
                        </ul>

<p>una vez obtenido un objeto SQLiteDatabase se pueden emplear los métodos: insert(), update(), delete(), query()
				</section>

				<section>
					<h2>SQLite</h2><h3>Usando Cursor</h3>

<p>Cuando relizamos una consulta mediante alguna variación del método query() obtenemos un objeto <a href="http://developer.android.com/reference/android/database/Cursor.html"><strong>Cursor</strong></a>. Este permite acceso de lectura-escritura al set de resultados. 
				</section>


				<section>

					<h3>Inspeccionando una bbdd con el shell</h3>
<p><pre><code data-trim>
adb -s emulator-5554 shell
# sqlite3 /data/data/com.example.google.rss.rssexample/databases/rssitems.db
SQLite version 3.3.12
Enter ".help" for instructions
.... enter commands, then quit...
sqlite> .exit 
</code></pre></p>
				</section>


			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
